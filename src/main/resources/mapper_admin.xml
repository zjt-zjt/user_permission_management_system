<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lanou.upms.mapper.TestMapper">

    <resultMap id="UserMap" type="user">
        <id column="id" property="userId"></id>
        <result column="username" property="username" />
        <result column="phone" property="phone" />
        <result column="email" property="email" />
        <result column="createTime" property="createTime" />
        <result column="status" property="status" />
        <result column="role_name" property="rolename" />

    </resultMap>
    <insert id="insertUser">
        insert into  user (username,password,phone,email)values
         (#{username},#{password},#{phone},#{email})

    </insert>
    <insert id="insertRole">
        insert  into role (role_name) values
        (#{roleName})
    </insert>

    <update id="update">
       update user set status = 2 where user_id = #{id}
    </update>


    <update id="updateUser">
     update user set phone=#{phone},email=#{email},password=#{password}
     where
     username=#{username}
    </update>




    <select id="queryAll" resultMap="UserMap">
       SELECT
         u.user_id id,
         u.username username,
         u.phone phone,
         u.email email,
         u.create_time createTime,
         u.status status,
         r.role_name
        FROM
         user u
        LEFT JOIN role r ON u.user_id = r.role_id
       where
       u.status = 1
    </select>

</mapper>