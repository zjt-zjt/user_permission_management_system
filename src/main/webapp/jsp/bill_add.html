<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../frame/layui/css/layui.css">
<link rel="stylesheet" href="../frame/static/css/style.css">
</head>
<body class="body">
	<form class="layui-form" action="">
		<div class="layui-form-item">
			<label class="layui-form-label"> 商品名称 </label>
			<div class="layui-input-block">
				<input type="text" name="productName" lay-verify="productName"
					autocomplete="off" placeholder="请输入商品名称" class="layui-input">
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 商品描述 </label>
			<div class="layui-input-block">
				<input type="text" name="productDesc" lay-verify="productDesc"
					autocomplete="off" placeholder="请输入商品描述" class="layui-input">
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 商品数量 </label>
			<div class="layui-input-block">
				<input type="text" name="productCount" lay-verify="productCount"
					autocomplete="off" placeholder="请输入商品数量" class="layui-input">
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 商品单位 </label>
			<div class="layui-input-block">
				<select name="productUnit" lay-verify="productUnit">
					<option value="">请选择单位</option>
					<option value="个">个</option>
					<option value="箱">箱</option>
					<option value="瓶">瓶</option>
				</select>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 商品总价 </label>
			<div class="layui-input-block">
				<input type="text" name="totalPrice" lay-verify="totalPrice"
					autocomplete="off" placeholder="请输入商品总价" class="layui-input">
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 供应商 </label>
			<div class="layui-input-block">
				<select id="proName" name="providerId" lay-verify="providerId">
				</select>
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label"> 是否支付 </label>
			<div class="layui-input-block">
				<select name="isPayment" lay-verify="isPayment">
					<option value="1">否</option>
					<option value="2">是</option>
				</select>
			</div>
		</div>
		<div class="layui-form-item">
			<button class="layui-btn" lay-submit="" lay-filter="addbill">保存</button>
		</div>
	</form>
</body>
</html>
<script type="text/javascript" src="../frame/layui/layui.js"></script>
<script type="text/javascript">
	layui.use([ 'form' ], function() {
		var form = layui.form;
		$ = layui.jquery;
		$.getJSON("/smbms2/ProviderJsonServlet", function(res) {
			var html = "";
			$.each(res, function() {
				html += "<option value="+this.id+">" + this.proName
						+ "</option>"
			});
			$("#proName").html(html);
			form.render('select');//刷新表单select样式
		});
		
		//表单验证
		form.verify({
			productName:function(value){
				if(value==""){
					return "商品名称不能为空";
				}else if(value.length<1){
					return "格式不正确";
				}
			},
			productDesc:function(value){
				if(value==""){
					return "商品描述不能为空";
				}else if(value.length<1){
					return "格式不正确";
				}
			}
		});
		//表单提交
		form.on("submit(addbill)",function(data){
			var d=data.field;
			/*
			参数1：请求路径(servlet)
			参数2：请求参数
			参数3：请求路径后用于接收返回值
			参数4：返回值类型
			*/
			$.post("/smbms2/BillAddServlet",{
				productName:d.productName,
				productDesc:d.productDesc,
				productUnit:d.productUnit,
				productCount:d.productCount,
				totalPrice:d.totalPrice,
				isPayment:d.isPayment,
				providerId:d.providerId
			},function(res){
				if(res.code>0){
					parent.winalert("添加成功",function(index){
						//点击确定后执行
						parent.tableRD();
						parent.winclose();
						parent.layer.close(index);
					});
				}
			},"json");
			return false;
		});	
	});
</script>



